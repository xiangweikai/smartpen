# 截图交互功能说明

## 功能概述

在截图显示界面实现了四种交互功能，用户可以通过底部菜单选择不同的工具，直接在截图上进行操作。所有配置都会自动保存到本地，并在下次启动时自动加载。

## 功能详情

### 1. 批注功能 (Annotation)
- **操作方式**: 触摸并拖拽在截图上绘制
- **配置选项**: 
  - 颜色选择：黑色、红色、黄色、绿色、蓝色
  - 线条粗细：1-20像素可调
- **特殊功能**: 清除按钮可清除所有批注内容
- **默认配置**: 红色，5像素粗细

### 2. 激光笔功能 (Laser)
- **操作方式**: 触摸时在触摸位置显示激光点
- **配置选项**:
  - 颜色选择：红色、绿色、蓝色
  - 激光点大小：1-20像素可调
- **效果**: 激光点跟随手指移动，实时显示
- **默认配置**: 红色，10像素大小

### 3. 放大镜功能 (Magnifier)
- **操作方式**: 触摸并移动，在触摸位置显示局部放大效果
- **配置选项**:
  - 放大镜大小：1-10级可调
  - 放大倍数：2x、3x、4x、5x可选
- **效果**: 圆形放大镜，鼠标位置为中心，显示放大后的局部内容
- **默认配置**: 5级大小，2倍放大

### 4. 聚光灯功能 (Spotlight)
- **操作方式**: 触摸并移动，以触摸位置为中心显示聚光灯效果
- **配置选项**:
  - 聚光灯大小：1-10级可调
  - 暗度调节：0-100%可调
- **效果**: 圆形聚光灯区域显示原图，其他区域变暗
- **默认配置**: 3级大小，80%暗度

## 配置管理

### 本地存储
- 使用SharedPreferences保存所有工具配置
- 应用启动时自动加载上次保存的配置
- 配置修改后立即保存到本地

### 默认配置
- 批注：红色，5像素粗细
- 激光笔：红色，10像素大小
- 放大镜：5级大小，2倍放大
- 聚光灯：3级大小，80%暗度

## Fragment显示控制

### 显示逻辑
1. **首次选择工具**: 显示对应的配置Fragment
2. **再次选择相同工具**: 隐藏配置Fragment
3. **选择不同工具**: 显示新工具的配置Fragment

### 应用配置
- 点击"应用"按钮后，配置立即生效并保存到本地
- 应用配置后，Fragment自动隐藏
- 下次选择该工具时，会显示当前保存的配置

## 技术实现

### 核心类
- `ScreenshotDisplayActivity`: 主界面，处理所有交互逻辑和配置管理
- `AnnotationFragment`: 批注配置界面
- `LaserFragment`: 激光笔配置界面
- `MagnifierFragment`: 放大镜配置界面
- `SpotlightFragment`: 聚光灯配置界面

### 关键技术
1. **触摸事件处理**: 通过`OnTouchListener`监听触摸事件
2. **Canvas绘制**: 使用`Canvas`和`Paint`进行图形绘制
3. **Bitmap操作**: 对截图进行局部截取、缩放等操作
4. **Fragment通信**: Fragment通过Activity接口更新配置
5. **SharedPreferences**: 本地配置存储和读取
6. **Fragment生命周期管理**: 动态显示和隐藏配置界面

### 配置同步机制
- Fragment中的配置改变时，通过`updateActivityConfig()`方法通知Activity
- Activity接收配置更新后，实时应用到当前工具并保存到本地
- Fragment初始化时从Activity获取当前配置并显示
- 所有配置都有详细的日志输出，便于调试

## 使用流程

1. 触发截图后，自动进入截图显示界面
2. 默认不显示任何配置Fragment
3. 通过底部菜单选择需要的工具
4. 首次选择工具时显示配置Fragment
5. 在配置Fragment中调整工具参数
6. 点击"应用"按钮保存配置并隐藏Fragment
7. 在截图上进行相应操作
8. 再次选择相同工具可隐藏配置Fragment
9. 批注工具支持清除功能，可清除所有绘制内容

## 注意事项

1. 放大镜功能需要足够的系统内存来处理Bitmap操作
2. 聚光灯的暗度调节会影响整体视觉效果
3. 所有绘制操作都是实时的，配置改变立即生效
4. 清除功能只清除批注内容，不影响其他工具的临时效果
5. 配置会自动保存，下次启动时保持上次的设置
6. Fragment显示逻辑确保界面简洁，避免频繁切换 