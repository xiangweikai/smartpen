# 颜色配置测试指南

## 测试目的
验证批注和激光笔的颜色配置是否正确工作，包括颜色选择、保存和加载。

## 测试步骤

### 1. 批注颜色测试

#### 1.1 启动截图显示Activity
- 触发截图功能，进入截图显示界面
- 确认底部导航默认选中批注工具

#### 1.2 测试颜色选择
1. 点击底部导航的批注按钮，显示配置Fragment
2. 依次选择不同颜色：
   - 黑色 (索引0)
   - 红色 (索引1) 
   - 黄色 (索引2)
   - 绿色 (索引3)
   - 蓝色 (索引4)
3. 每次选择后，在截图上绘制一些线条
4. 观察绘制线条的颜色是否正确

#### 1.3 验证颜色保存
1. 选择一个颜色并绘制
2. 点击"应用设置"按钮
3. 关闭Activity，重新进入
4. 检查Fragment中显示的颜色是否与之前选择的一致
5. 绘制线条，确认颜色正确

### 2. 激光笔颜色测试

#### 2.1 测试颜色选择
1. 点击底部导航的激光笔按钮，显示配置Fragment
2. 依次选择不同颜色：
   - 红色 (索引0)
   - 绿色 (索引1)
   - 蓝色 (索引2)
3. 每次选择后，在截图上移动鼠标
4. 观察激光点的颜色是否正确

#### 2.2 验证颜色保存
1. 选择一个颜色
2. 点击"应用设置"按钮
3. 关闭Activity，重新进入
4. 检查Fragment中显示的颜色是否与之前选择的一致
5. 移动鼠标，确认激光点颜色正确

## 调试日志检查

### 批注颜色日志
在Logcat中搜索以下标签，检查颜色转换是否正确：
- `AnnotationFragment`: 颜色索引和颜色值的转换
- `ScreenshotDisplayActivity`: 批注配置更新和绘制

### 激光笔颜色日志
在Logcat中搜索以下标签：
- `LaserFragment`: 颜色索引和颜色值的转换
- `ScreenshotDisplayActivity`: 激光笔配置更新和绘制

## 预期结果

### 颜色值对应关系
- 批注颜色：
  - 索引0 → 0xFF000000 (黑色)
  - 索引1 → 0xFFFF0000 (红色)
  - 索引2 → 0xFFFFFF00 (黄色)
  - 索引3 → 0xFF00FF00 (绿色)
  - 索引4 → 0xFF0000FF (蓝色)

- 激光笔颜色：
  - 索引0 → 0xFFFF0000 (红色)
  - 索引1 → 0xFF00FF00 (绿色)
  - 索引2 → 0xFF0000FF (蓝色)

### 正常行为
1. 颜色选择后立即生效
2. 配置保存后重启应用仍然有效
3. Fragment中显示的颜色选项与实际绘制颜色一致
4. 调试日志显示正确的颜色值转换

## 常见问题排查

### 问题1: 颜色选择不生效
- 检查Fragment中的颜色选择监听器是否正确设置
- 检查ViewModel中的颜色值是否正确更新
- 检查Activity中的配置更新方法是否被调用

### 问题2: 颜色保存失败
- 检查SharedPreferences的保存逻辑
- 检查配置键名是否正确
- 检查Activity的onCreate中是否正确加载配置

### 问题3: 颜色显示错误
- 检查颜色值转换方法中的颜色值是否正确
- 检查Paint对象的颜色设置是否正确
- 检查Bitmap的配置是否支持透明度

## 修复记录

### 已修复的问题
1. **批注Fragment中黑色选项无法选中**: 在`observeViewModel`方法中添加了对颜色索引0的处理
2. **颜色转换调试**: 添加了详细的调试日志，显示颜色索引和颜色值的转换过程
3. **配置更新日志**: 在Activity中添加了颜色配置更新的详细日志

### 测试建议
1. 使用Logcat过滤相关标签，观察颜色转换过程
2. 测试所有颜色选项，确保都能正常工作
3. 测试配置保存和加载的完整性
4. 在不同设备上测试，确保兼容性 